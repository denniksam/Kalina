<html>
<head>
    <meta charset='utf-8'/>
    <script src="kalina.js"></script>
</head>
<body>
<div id="d0"></div>

   <script>
    selftest = [];
    selftest.push({'blocksize':128,'keysize':128,'mode':'encrypt',
					'block':'101112131415161718191A1B1C1D1E1F',
					'key':'000102030405060708090A0B0C0D0E0F',
					'result':'81BF1C7D779BAC20E1C9EA39B4D2AD06'});
                    
    selftest.push({'blocksize':128,'keysize':128,'mode':'decrypt',
					'block':'1F1E1D1C1B1A19181716151413121110',
					'key':'0F0E0D0C0B0A09080706050403020100',
					'result':'7291EF2B470CC7846F09C2303973DAD7'});
                                        
    selftest.push({'blocksize':128,'keysize':256,'mode':'encrypt',
					'block':'202122232425262728292A2B2C2D2E2F',
					'key':'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F',
					'result':'58EC3E091000158A1148F7166F334F14'});
                                        
    selftest.push({'blocksize':128,'keysize':256,'mode':'decrypt',
					'block':'2F2E2D2C2B2A29282726252423222120',
					'key':'1F1E1D1C1B1A191817161514131211100F0E0D0C0B0A09080706050403020100',
					'result':'F36DB456CEFDDFE1B45B5F7030CAD996'});
                                                            
    selftest.push({'blocksize':256,'keysize':256,'mode':'encrypt',
					'block':'202122232425262728292A2B2C2D2E2F303132333435363738393A3B3C3D3E3F',
					'key':'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F',
					'result':'F66E3D570EC92135AEDAE323DCBD2A8CA03963EC206A0D5A88385C24617FD92C'});
                                        
    selftest.push({'blocksize':256,'keysize':256,'mode':'decrypt',
					'block':'3F3E3D3C3B3A393837363534333231302F2E2D2C2B2A29282726252423222120',
					'key':'1F1E1D1C1B1A191817161514131211100F0E0D0C0B0A09080706050403020100',
					'result':'7FC5237896674E8603C1E9B03F8B4BA3AB5B7C592C3FC3D361EDD12586B20FE3'});

    selftest.push({'blocksize':256,'keysize':512,'mode':'encrypt',
					'block':'404142434445464748494A4B4C4D4E4F505152535455565758595A5B5C5D5E5F',
					'key':'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132333435363738393A3B3C3D3E3F',
					'result':'606990E9E6B7B67A4BD6D893D72268B78E02C83C3CD7E102FD2E74A8FDFE5DD9'});
                                        
    selftest.push({'blocksize':256,'keysize':512,'mode':'decrypt',
					'block':'5F5E5D5C5B5A595857565554535251504F4E4D4C4B4A49484746454443424140',
					'key':'3F3E3D3C3B3A393837363534333231302F2E2D2C2B2A292827262524232221201F1E1D1C1B1A191817161514131211100F0E0D0C0B0A09080706050403020100',
					'result':'18317A2767DAD482BCCD07B9A1788D075E7098189E5F84972D0B916D79BA6AE0'});
                    
    selftest.push({'blocksize':512,'keysize':512,'mode':'encrypt',
					'block':'404142434445464748494A4B4C4D4E4F505152535455565758595A5B5C5D5E5F606162636465666768696A6B6C6D6E6F707172737475767778797A7B7C7D7E7F',
					'key':'000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132333435363738393A3B3C3D3E3F',
					'result':'4A26E31B811C356AA61DD6CA0596231A67BA8354AA47F3A13E1DEEC320EB56B895D0F417175BAB662FD6F134BB15C86CCB906A26856EFEB7C5BC6472940DD9D9'});
                                        
    selftest.push({'blocksize':512,'keysize':512,'mode':'decrypt',
					'block':'7F7E7D7C7B7A797877767574737271706F6E6D6C6B6A696867666564636261605F5E5D5C5B5A595857565554535251504F4E4D4C4B4A49484746454443424140',
					'key':'3F3E3D3C3B3A393837363534333231302F2E2D2C2B2A292827262524232221201F1E1D1C1B1A191817161514131211100F0E0D0C0B0A09080706050403020100',
					'result':'CE80843325A052521BEAD714E6A9D829FD381E0EE9A845BD92044554D9FA46A3757FEFDB853BB1F297FF9D833B75E66AAF4157ABB5291BDCF094BB13AA5AFF22'});
var res,a,k;
    for(i=0;i<selftest.length;i++){
        res=selftest[i].blocksize+'/'+selftest[i].keysize+' - '+selftest[i].mode;
        try{
            k=new Kalina(selftest[i].blocksize,selftest[i].keysize);
            k.setKeyHex(selftest[i].key);
            if(selftest[i].mode == 'encrypt'){
                a = k.encryptHex(selftest[i].block).toUpperCase();
            }
            else{
                a = k.decryptHex(selftest[i].block).toUpperCase();
            }
            if(a==selftest[i].result) res+=' Passed<br/>';
            else res+=' Failed<br/>';
            res+=a+'<br>'+selftest[i].result+'<br>';
        }
        catch(err){
            res+=err+'<br>';
        }
        window.d0.innerHTML+=res+'<hr><br>';
    }
   </script>
</body>
</html>